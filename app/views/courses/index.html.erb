<div class="container">
  <div class="row">
    <div class="col-12 mt-3">
      <h2> Courses Index </h2>
    </div>
  </div>
</div>

<div class="container">
  <div class="row">
    <div class="col-12 mt-3">
      <p><%= link_to "Create New Course", new_course_path  %></p>

      <table class="table" id="courses">
        <thead>
          <tr>
            <th scope="col">Department</th>
            <th scope="col">Course</th>
            <th scope="col">Number of Tutors</th>
            <th scope="col">View</th>
          </tr>
        </thead>
        <tbody>
          <% @courses.each do |course| %>
          <tr class='courseInfo'>
            <td><%= Department.find_by(id: course.department_id).department_name %></td>
            <td><%= course.course_name  %></td>
            <td><%= course.users.count  %></td>
            <td><a href="<%= course_path(course) %>"><i class="far fa-edit"></i></a></td>
          </tr>
          <% end %>
        </tbody>
      </table>
    </div>

    <script>
      $(function() {
        $('#courses').DataTable();
        // $('#courses').api().columns().every(function () {
        //   console.log('test');
        //   var column = this;
        //   var select = $('<select class="form-select"><option value=""></option></select>')
        //     .prependTo($(column.header()))
        //     .on('change', function() {
        //       var val = $.fn.dataTable.util.escapeRegex(
        //         $(this).val()
        //       );

        //       column
        //         .search(val ? '^'+val+'$' : '', true, false)
        //         .draw();
        //     });

        //   column.data().unique().sort().each(function (d, j) {
        //     select.append('<option value="'+d+'">'+d+'</option>')
        //   });
        // });
      });
    </script>
  </div>
